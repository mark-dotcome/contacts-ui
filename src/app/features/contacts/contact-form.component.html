<p-toast></p-toast>

<div class="p-4">
  <div class="mb-4">
    <a routerLink="/contacts" class="text-primary no-underline">
      <i class="pi pi-arrow-left mr-2"></i>Back to Contacts
    </a>
  </div>

  <p-card>
    <ng-template pTemplate="header">
      <div class="p-4 pb-0">
        <h2 class="text-2xl font-bold text-900 m-0">
          {{ isEditMode ? 'Edit Contact' : 'Create New Contact' }}
        </h2>
        <p class="text-600 mt-1">
          {{ isEditMode ? 'Update contact information' : 'Add a new contact to your list' }}
        </p>
      </div>
    </ng-template>

    <form (ngSubmit)="onSubmit()">
      <h3 class="text-lg font-semibold text-900 mb-3">
        <i class="pi pi-user mr-2"></i>Personal Information
      </h3>
      
      <div class="grid">
        <div class="col-12 md:col-6">
          <label for="firstName" class="block text-900 font-medium mb-2">First Name *</label>
          <input 
            id="firstName" 
            type="text" 
            pInputText 
            [(ngModel)]="contact.firstName" 
            name="firstName"
            class="w-full" 
            placeholder="Enter first name"
            required
          />
        </div>
        <div class="col-12 md:col-6">
          <label for="lastName" class="block text-900 font-medium mb-2">Last Name *</label>
          <input 
            id="lastName" 
            type="text" 
            pInputText 
            [(ngModel)]="contact.lastName" 
            name="lastName"
            class="w-full" 
            placeholder="Enter last name"
            required
          />
        </div>
        <div class="col-12 md:col-6">
          <label for="email" class="block text-900 font-medium mb-2">Email Address *</label>
          <input 
            id="email" 
            type="email" 
            pInputText 
            [(ngModel)]="contact.email" 
            name="email"
            class="w-full" 
            placeholder="Enter email address"
            required
          />
        </div>
        <div class="col-12 md:col-6">
          <label for="phone" class="block text-900 font-medium mb-2">Phone Number *</label>
          <input 
            id="phone" 
            type="tel" 
            pInputText 
            [(ngModel)]="contact.phone" 
            name="phone"
            class="w-full" 
            placeholder="(555) 000-0000"
            required
          />
        </div>
      </div>

      <h3 class="text-lg font-semibold text-900 mb-3 mt-4">
        <i class="pi pi-map-marker mr-2"></i>Address Information
      </h3>

      <div class="grid">
        <div class="col-12">
          <label for="street" class="block text-900 font-medium mb-2">Street Address *</label>
          <input 
            id="street" 
            type="text" 
            pInputText 
            [(ngModel)]="contact.address.street" 
            name="street"
            class="w-full" 
            placeholder="Enter street address"
            required
          />
        </div>
        <div class="col-12 md:col-6">
          <label for="city" class="block text-900 font-medium mb-2">City *</label>
          <input 
            id="city" 
            type="text" 
            pInputText 
            [(ngModel)]="contact.address.city" 
            name="city"
            class="w-full" 
            placeholder="Enter city"
            required
          />
        </div>
        <div class="col-12 md:col-3">
          <label for="state" class="block text-900 font-medium mb-2">State *</label>
          <p-select 
            id="state"
            [(ngModel)]="contact.address.state" 
            name="state"
            [options]="states" 
            optionLabel="name"
            optionValue="code"
            placeholder="Select state"
            styleClass="w-full"
          ></p-select>
        </div>
        <div class="col-12 md:col-3">
          <label for="zip" class="block text-900 font-medium mb-2">ZIP Code *</label>
          <input 
            id="zip" 
            type="text" 
            pInputText 
            [(ngModel)]="contact.address.zip" 
            name="zip"
            class="w-full" 
            placeholder="Enter ZIP code"
            required
          />
        </div>
      </div>

      <div class="grid mt-4">
        <div class="col-12 md:col-6">
          <label for="app" class="block text-900 font-medium mb-2">Application *</label>
          <p-select 
            id="app"
            [(ngModel)]="contact.app" 
            name="app"
            [options]="apps" 
            placeholder="Select application"
            styleClass="w-full"
          ></p-select>
        </div>
      </div>

      @if (isEditMode && contact.createdBy) {
        <div class="surface-100 border-round p-3 mt-4">
          <div class="grid">
            <div class="col-12 md:col-6">
              <div class="text-600 text-sm">Created by:</div>
              <div class="font-medium">{{ contact.createdBy }}</div>
              <div class="text-600 text-sm mt-2">Created on:</div>
              <div class="font-medium">{{ formatDate(contact.createdDt) }}</div>
            </div>
            <div class="col-12 md:col-6">
              <div class="text-600 text-sm">Last modified by:</div>
              <div class="font-medium">{{ contact.modifiedBy }}</div>
              <div class="text-600 text-sm mt-2">Last modified on:</div>
              <div class="font-medium">{{ formatDate(contact.modifiedDt) }}</div>
            </div>
          </div>
        </div>
      }

      <div class="flex justify-content-end gap-2 mt-4">
        <p-button 
          label="Cancel" 
          icon="pi pi-times" 
          severity="secondary"
          [outlined]="true"
          routerLink="/contacts"
        ></p-button>
        <p-button 
          type="submit"
          [label]="isEditMode ? 'Save Changes' : 'Create Contact'" 
          [icon]="isEditMode ? 'pi pi-check' : 'pi pi-plus'"
          [loading]="isLoading"
        ></p-button>
      </div>
    </form>
  </p-card>
</div>
